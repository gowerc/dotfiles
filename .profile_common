

# Load local machine specific profile (should set $NICKNAME)
[ -r ~/.profile_local ] && source ~/.profile_local

# Update PATH
export PATH=$HOME/.local/bin:$PATH


# Update XDG path to find desktop files
if [ -d $HOME/.local/share/applications ] ; then 
    export XDG_DATA_DIRS=$HOME/.local/share/applications:$XDG_DATA_DIRS
fi


# Explicitly set XDG config so that Ghosty on mac uses it
# to source it's config file
XDG_CONFIG_HOME=${XDG_CONFIG_HOME:-$HOME/.config}
export XDG_CONFIG_HOME



# Aliases
alias ls="ls --color"
alias ll="ls -lh"
alias la="ls -a"

alias cd-="cd -"
alias cd..="cd .."

alias gs="git status"
alias gb="git branch --all"
alias gl="git log --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit"
alias gg="git log --graph -n 10 --oneline"

alias psa="source venv/bin/activate"

# If nvim is installed then use that by default instead of vim
command -v nvim &> /dev/null && alias vim="nvim"

# If open isn't available (on Linux) set to xdg-open
command -v xdg-open &> /dev/null && alias open="xdg-open"

### Set VIM as default editor for all programs
export VISUAL=vim
export EDITOR="$VISUAL"

### If installed enable pyenv
command -v pyenv &> /dev/null && eval "$(pyenv init -)" 

function about () {
    echo ""
    echo "          |_| o";
    echo "          | | |";
    echo ""
    STRING='%-11s - %s\n'
    PREFIX="  "
    printf "$STRING" "${PREFIX}User" "${USER-Unknown}"
    printf "$STRING" "${PREFIX}Host" "${HOST-Unknown}"
    printf "$STRING" "${PREFIX}Nickname" "${NICKNAME-Unknown}"
    if command -v sw_vers &> /dev/null ; then
        LOCAL_SYS=$(sw_vers | awk '/ProductName/ {printf $2 " (" }  /ProductVersion/ {print $2 ")"}')
    elif [ -r /etc/os-release ]; then
        LOCAL_SYS_1=$(cat /etc/os-release | \
                awk '/^NAME/ {printf $0}' | \
                sed -e 's/NAME="//' | \
                sed -e 's/"$//g')
        LOCAL_SYS_2=$(cat /etc/os-release | \
                awk '/^VERSION_ID/ {printf $0}' | \
                sed -e 's/VERSION_ID=//' | \
                sed -e 's/"//g')
        LOCAL_SYS="$LOCAL_SYS_1 ($LOCAL_SYS_2)"
    else
        echo Unable to identify system
    fi
    printf "$STRING" "${PREFIX}System" "${LOCAL_SYS-Unknown}"
    echo ""
}

# Only execute "about" if we are running in interactive mode
# Otherwise the startup script breaks sftp connections
#case $- in *i*) about;; esac
case $- in *i*) export about;; esac



shell_debug() {
    printf "\nDebug Information for Shell\n"
    echo "----------------------------------"
    printf "%s" "Interactive-Shell  = "
    case $- in
        *i*) echo "True" ;;
        *) echo "False" ;;
    esac
    printf "%s" "Login-Shell        = "
    case $0 in
        -*) echo "True" ;;
        *) echo "False" ;;
    esac
    echo -n "\$PS1 set           = "
    if [ -n "${PS1+x}" ]; then
        echo "True"
    else
        echo "False"
    fi
    echo "\$TERM              = ${TERM}"
    echo "\$(tty)             = $(tty)"
    echo "\$USER              = $USER"
    echo "\$LANG              = $LANG"
    echo "\$LC_ALL            = $LC_ALL"
    echo "\$SHLVL             = ${SHLVL:-1}"
    echo "\$SHELL             = $SHELL"
}



#
# Copy and paste from system clipboard
#     Uses xclip on Linux and pbcopy/pbpaste on macos
#     Usage:   `echo Hello | _copy` to
#
if command -v xclip 1>/dev/null; then
	_copy() {
        cat | xclip -selection clipboard
	}
	_paste() {
		xclip -selection clipboard -o
	}
elif command -v pbcopy 1>/dev/null; then
	_copy() {
        cat | pbcopy
	}
	_paste() {
		pbpaste
	}
fi


